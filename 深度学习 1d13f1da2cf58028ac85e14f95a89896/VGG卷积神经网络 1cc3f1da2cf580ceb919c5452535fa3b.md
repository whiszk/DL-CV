# VGG卷积神经网络

日期: 04/03/2025
状态: 完成

## 一、CNN

**CNN**，全称是 **Convolutional Neural Network（卷积神经网络）**，是一种专门用于处理图像数据的神经网络。

它的核心特点是：

- 用**卷积层**提取图像的局部特征（比如边缘、纹理等）；
- 使用**池化层**降采样，压缩特征图大小；
- 最后接**全连接层**用于分类或者回归任务。

CNN是一个大类，**里面有很多种不同的架构**，比如：AlexNet，VGG等

---

## **二、VGG的工作流程（以VGG16为例）**

> 参考博客：
> 
> 
> [深度学习——VGG16模型详解-CSDN博客](https://blog.csdn.net/qq_42012782/article/details/123222042)
> 

**VGG**是由牛津大学的Visual Geometry Group（缩写为VGG）提出的一种卷积神经网络架构，特点是用更小的卷积核（**3×3**）+ 堆叠更多层，构造出更深的卷积神经网络

根据卷积核的大小核卷积层数，VGG共有6种配置，分别为A、A-LRN、B、C、D、E，其中D和E两种是最为常用的VGG16和VGG19。

---

### 1.输入层

**224×224×3的RGB图像**

224的尺寸大小是VGG组的经验之选，这个尺寸在**保证足够图像细节**的同时，**又不会太大**，适合当时的硬件资源训练，例如和VGG同期的AlexNet用的是 227×227，GoogLeNet用的也是224×224；同时VGG16 使用了5次**2×2最大池化（stride=2）**，每次池化都会减半图像尺寸，224经五次池化后，特征图尺寸就变为`7×7`，方便接入全连接层。

---

### 2.卷积层组

VGG16由**5个卷积模块**（Block1~Block5）和**3个全连接层**组成，每个卷积模块内部都是若干卷积层 + 一个最大池化层，全连接层用于分类。下表中**通道数**指的是，在该卷积模块**作用后**，图片维度的大小

| Block | 卷积层数 | 通道数 | 池化后尺寸 |
| --- | --- | --- | --- |
| Block1 | 2 | 64 | 112×112 |
| Block2 | 2 | 128 | 56×56 |
| Block3 | 3 | 256 | 28×28 |
| Block4 | 3 | 512 | 14×14 |
| Block5 | 3 | 512 | 7×7 |

以Block1的过程为例：

**输入尺寸**：224×224×3（RGB图像）

**结构**：

- Conv1_1: **64个3×3×3的卷积核**，输入3通道 → 输出64通道
单个卷积核对输入图像3个通道上的像素值进行加权，所以有27个权重值，stride=1，padding=1，输出224×224的卷积结果，64个卷积核生成64个通道，每个通道一个偏置，参数总数为3×3×3×64+64=1792
- Conv1_2: **64个3×3×64的卷积核**，输入64通道 → 输出64通道
单个卷积核对输入图像64个通道上的像素值进行加权，所以**权重值数量为3×3×64**，64个卷积核生成64个通道，参数总数为3×3×64×64+64=36928
- MaxPool1: 2×2最大池化（stride=2）
经两次卷积完成后的特征图尺寸为224×224×64，对每一个通道进行2×2最大池化时，因为步长与窗口大小相同，所以窗口无重叠，并且图片尺寸减半

**输出尺寸**：112×112×64

后面的几个block同理，在同个block上，各卷积层的卷积核数量相等，每个block的第一层卷积核通道数，与上一个block输出的特征图通道数相同。

---

### 3.全连接层

五个block卷积与池化完成后，现在得到了512个通道的7×7特征图

先经过**flatte层，**将特征图展平为向量，维度7×7×512=25088

再给到全连接层fc1，输入节点数量为25088，输出节点数为4096，激活函数为relu

再给到全连接层fc2，输入节点数量为4096，输出节点数为4096，激活函数为relu

最后是输出层fc3，输入节点数量为4096，输出节点数为1000（当时比赛的类别数量），激活函数为**softmax**（softmax是将模型输出“归一化”为概率分布的激活函数，是多分类任务中最常用的输出层函数）

![12e58499589f9f9b8db62909c14a9ba2.png](VGG%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%201cc3f1da2cf580ceb919c5452535fa3b/12e58499589f9f9b8db62909c14a9ba2.png)